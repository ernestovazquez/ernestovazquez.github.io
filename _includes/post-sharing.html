<!--
 Post sharing snippet

 v2.1
 https://github.com/cotes2020/jekyll-theme-chirpy
 Â© 2019 Cotes Chung
 Published under the MIT License
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">{{ site.data.share.label }}</span>
  <span class="share-icons">
    {% capture title %}{{ page.title }} - {{ site.title }}{% endcapture %}
    {% assign url = page.url | relative_url | prepend: site.url %}

    {% for share in site.data.share.platforms %}
      {% assign link = share.link | replace: 'TITLE', title | replace: 'URL', url %}
        <a href="{{ link }}" data-toggle="tooltip" data-placement="top"
          title="{{ share.type }}" target="_blank">
          <i class="fa-fw {{ share.icon }}"></i>
        </a>
    {% endfor %}

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>
  </span>
</div>

<script>
  function copyLink() {
    const url = '{{ page.url | relative_url | prepend: site.url }}';
    navigator.clipboard.writeText(url).then(() => {
      const icon = document.querySelector('.fa-link');
      const originalTitle = icon.getAttribute('title');
      const successTitle = 'Link copied successfully!';

      icon.setAttribute('title', successTitle);
      icon.setAttribute('data-original-title', successTitle);
      // Bootstrap tooltip update
      var tooltip = bootstrap.Tooltip.getInstance(icon);
      tooltip.setContent({ '.tooltip-inner': successTitle });

      setTimeout(() => {
        icon.setAttribute('title', originalTitle);
        icon.setAttribute('data-original-title', originalTitle);
        // Bootstrap tooltip update
        tooltip.setContent({ '.tooltip-inner': originalTitle });
      }, 2000);
    }).catch(err => {
      console.error('Failed to copy: ', err);
    });
  }

  document.addEventListener('DOMContentLoaded', function () {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl);
    });
  });
</script>

