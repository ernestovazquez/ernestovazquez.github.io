<!--
 Post sharing snippet

 v2.1
 https://github.com/cotes2020/jekyll-theme-chirpy
 Â© 2019 Cotes Chung
 Published under the MIT License
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">{{ site.data.share.label }}</span>
  <span class="share-icons">
    {% capture title %}{{ page.title }} - {{ site.title }}{% endcapture %}
    {% assign url = page.url | relative_url | prepend: site.url %}

    {% for share in site.data.share.platforms %}
      {% assign link = share.link | replace: 'TITLE', title | replace: 'URL', url %}
        <a href="{{ link }}" data-toggle="tooltip" data-placement="top"
          title="{{ share.type }}" target="_blank">
          <i class="fa-fw {{ share.icon }}"></i>
        </a>
    {% endfor %}

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
      onclick="copyLink()"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

<script>
  function copyLink() {
    const url = '{{ page.url | relative_url | prepend: site.url }}';
    navigator.clipboard.writeText(url).then(() => {
      const button = document.getElementById('copy-link');
      const originalTitle = button.getAttribute('title');
      const successTitle = button.getAttribute('data-title-succeed');

      button.setAttribute('title', successTitle);
      button.setAttribute('data-bs-original-title', successTitle);
      // Bootstrap tooltip update
      var tooltip = bootstrap.Tooltip.getInstance(button);
      tooltip.setContent({ '.tooltip-inner': successTitle });

      setTimeout(() => {
        button.setAttribute('title', originalTitle);
        button.setAttribute('data-bs-original-title', originalTitle);
        // Bootstrap tooltip update
        tooltip.setContent({ '.tooltip-inner': originalTitle });
      }, 2000);
    }).catch(err => {
      console.error('Failed to copy: ', err);
    });
  }
</script>

